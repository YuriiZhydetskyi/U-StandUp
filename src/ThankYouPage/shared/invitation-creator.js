// ==========================================
// Invitation Creator Module (Shared)
// ==========================================

// Config is expected to be set globally before this script loads:
// window.INVITATION_CONFIG = { eventName, eventDate, eventDateISO, paymentUrl, emoji, themeGradient }

(function() {
    'use strict';

    const invConfig = window.INVITATION_CONFIG || {};

    // Ukrainian day names in genitive case for "–¶—å–æ–≥–æ/–ù–∞—Å—Ç—É–ø–Ω–æ–≥–æ X"
    const DAY_NAMES_GENITIVE = {
        0: { this: '–¶—ñ—î—ó –Ω–µ–¥—ñ–ª—ñ', next: '–ù–∞—Å—Ç—É–ø–Ω–æ—ó –Ω–µ–¥—ñ–ª—ñ' },
        1: { this: '–¶—å–æ–≥–æ –ø–æ–Ω–µ–¥—ñ–ª–∫–∞', next: '–ù–∞—Å—Ç—É–ø–Ω–æ–≥–æ –ø–æ–Ω–µ–¥—ñ–ª–∫–∞' },
        2: { this: '–¶—å–æ–≥–æ –≤—ñ–≤—Ç–æ—Ä–∫–∞', next: '–ù–∞—Å—Ç—É–ø–Ω–æ–≥–æ –≤—ñ–≤—Ç–æ—Ä–∫–∞' },
        3: { this: '–¶—ñ—î—ó —Å–µ—Ä–µ–¥–∏', next: '–ù–∞—Å—Ç—É–ø–Ω–æ—ó —Å–µ—Ä–µ–¥–∏' },
        4: { this: '–¶—å–æ–≥–æ —á–µ—Ç–≤–µ—Ä–≥–∞', next: '–ù–∞—Å—Ç—É–ø–Ω–æ–≥–æ —á–µ—Ç–≤–µ—Ä–≥–∞' },
        5: { this: "–¶—ñ—î—ó –ø'—è—Ç–Ω–∏—Ü—ñ", next: "–ù–∞—Å—Ç—É–ø–Ω–æ—ó –ø'—è—Ç–Ω–∏—Ü—ñ" },
        6: { this: '–¶—ñ—î—ó —Å—É–±–æ—Ç–∏', next: '–ù–∞—Å—Ç—É–ø–Ω–æ—ó —Å—É–±–æ—Ç–∏' }
    };

    /**
     * Get smart date label based on how many days until the event
     * - Today: "–°—å–æ–≥–æ–¥–Ω—ñ"
     * - Tomorrow: "–ó–∞–≤—Ç—Ä–∞"
     * - Day after tomorrow: "–ü—ñ—Å–ª—è–∑–∞–≤—Ç—Ä–∞"
     * - This week: "–¶—å–æ–≥–æ –ø–æ–Ω–µ–¥—ñ–ª–∫–∞", "–¶—ñ—î—ó —Å–µ—Ä–µ–¥–∏", etc.
     * - Next week or later: "–ù–∞—Å—Ç—É–ø–Ω–æ–≥–æ –ø–æ–Ω–µ–¥—ñ–ª–∫–∞", "–ù–∞—Å—Ç—É–ø–Ω–æ—ó —Å–µ—Ä–µ–¥–∏", etc.
     */
    function getSmartDateLabel(eventDateISO) {
        if (!eventDateISO) return null;

        const today = new Date();
        today.setHours(0, 0, 0, 0);

        const eventDate = new Date(eventDateISO);
        eventDate.setHours(0, 0, 0, 0);

        const diffTime = eventDate.getTime() - today.getTime();
        const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24));

        if (diffDays === 0) return '–°—å–æ–≥–æ–¥–Ω—ñ';
        if (diffDays === 1) return '–ó–∞–≤—Ç—Ä–∞';
        if (diffDays === 2) return '–ü—ñ—Å–ª—è–∑–∞–≤—Ç—Ä–∞';

        const eventDayOfWeek = eventDate.getDay();
        const todayDayOfWeek = today.getDay();

        // Check if event is this week (same ISO week or within 6 days and not past Sunday)
        const daysUntilSunday = (7 - todayDayOfWeek) % 7 || 7;
        const isThisWeek = diffDays <= daysUntilSunday && diffDays > 0;

        if (isThisWeek) {
            return DAY_NAMES_GENITIVE[eventDayOfWeek].this;
        }

        return DAY_NAMES_GENITIVE[eventDayOfWeek].next;
    }

    // Analytics tracking
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxvSjgwH2l9kcriQKy7yQTGlnd8pEr9-bUPu3xQYjTZaECrMHZV0V68e5Y5_-UItoE1Yg/exec';

    function trackEvent(eventType, extraData = {}) {
        const data = new URLSearchParams({
            timestamp: new Date().toISOString(),
            page: window.location.pathname,
            eventType: eventType,
            eventName: invConfig.eventName || '',
            ...extraData
        });

        if (navigator.sendBeacon) {
            navigator.sendBeacon(GOOGLE_SCRIPT_URL, data);
        } else {
            fetch(GOOGLE_SCRIPT_URL + '?' + data.toString(), {
                method: 'GET',
                mode: 'no-cors'
            }).catch(() => {});
        }
    }

    // Build templates dynamically based on config
    function buildTemplates() {
        const eventDate = invConfig.eventDate || '15 –≥—Ä—É–¥–Ω—è';
        const eventDateISO = invConfig.eventDateISO || null;
        const paymentUrl = invConfig.paymentUrl || 'https://secure.wayforpay.com/payment/winterstandup';
        const city = invConfig.city || '–ö–µ–ª—å–Ω—ñ';
        const time = invConfig.time || '19:30';

        // Get smart date label (–°—å–æ–≥–æ–¥–Ω—ñ, –ó–∞–≤—Ç—Ä–∞, –¶—å–æ–≥–æ –ø–æ–Ω–µ–¥—ñ–ª–∫–∞, etc.)
        const smartDateLabel = getSmartDateLabel(eventDateISO) || '–ù–∞—Å—Ç—É–ø–Ω–æ–≥–æ –ø–æ–Ω–µ–¥—ñ–ª–∫–∞';

        return {
            casual: {
                name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π',
                icon: 'üòä',
                text: `{${smartDateLabel}}, ${eventDate}, —è –π–¥—É –Ω–∞ {—É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π —Å—Ç–µ–Ω–¥–∞–ø} —É ${city}. {–ë—É–¥—É –¥—É–∂–µ —Ä–∞–¥–∏–π/–ë—É–¥—É —â–∞—Å–ª–∏–≤–∏–π/–ë—É–¥–µ –∫—Ä—É—Ç–æ/–ë—É–¥–µ —Å—É–ø–µ—Ä/–ö–ª–∞—Å–Ω–æ –±—É–¥–µ}, —è–∫—â–æ —Ç–∏ {–ø—Ä–∏—î–¥–Ω–∞—î—à—Å—è/—Å–∫–ª–∞–¥–µ—à –∫–æ–º–ø–∞–Ω—ñ—é/—Ç–µ–∂ –ø—Ä–∏–π–¥–µ—à}. –†–∞–∑–æ–º –±—É–¥–µ –≤–µ—Å–µ–ª—ñ—à–µ —ñ –º–∏ –∑–º–æ–∂–µ–º–æ {–≥–∞—Ä–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —á–∞—Å/–≤—ñ–¥–ø–æ—á–∏—Ç–∏/–≤–µ—Å–µ–ª–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —á–∞—Å} –Ω–µ —Ç—ñ–ª—å–∫–∏ –ø—ñ–¥ —á–∞—Å —Å—Ç–µ–Ω–¥–∞–ø—É, –∞ –π –ø—ñ—Å–ª—è –Ω—å–æ–≥–æ. {–ú–æ–∂–µ –Ω–∞–≤—ñ—Ç—å –ø–æ–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—å —ñ–∑ –∫–∏–º–æ—Å—å.} \n–ö–≤–∏—Ç–∫–∏ –º–æ–∂–µ—à –ø—Ä–∏–¥–±–∞—Ç–∏ –æ—Å—å —Ç—É—Ç: ${paymentUrl}`,
                variations: [
                    {
                        word: `{${smartDateLabel}}`,
                        alternatives: [smartDateLabel, eventDate],
                        custom: true
                    },
                    {
                        word: '{—É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π —Å—Ç–µ–Ω–¥–∞–ø}',
                        alternatives: ['—Å—Ç–µ–Ω–¥–∞–ø —à–æ—É', '–∫–æ–º–µ–¥—ñ–π–Ω–µ —à–æ—É', '–≥—É–º–æ—Ä–∏—Å—Ç–∏—á–Ω–∏–π –≤–µ—á—ñ—Ä', '–≤–µ—á—ñ—Ä –≥—É–º–æ—Ä—É'],
                        custom: true
                    },
                    {
                        word: '{–ë—É–¥—É –¥—É–∂–µ —Ä–∞–¥–∏–π/–ë—É–¥—É —â–∞—Å–ª–∏–≤–∏–π/–ë—É–¥–µ –∫—Ä—É—Ç–æ/–ë—É–¥–µ —Å—É–ø–µ—Ä/–ö–ª–∞—Å–Ω–æ –±—É–¥–µ}',
                        alternatives: ['–ë—É–¥—É —â–∞—Å–ª–∏–≤–∏–π', '–ë—É–¥–µ –∫—Ä—É—Ç–æ', '–ë—É–¥–µ —Å—É–ø–µ—Ä', '–ö–ª–∞—Å–Ω–æ –±—É–¥–µ'],
                        custom: true
                    },
                    {
                        word: '{–ø—Ä–∏—î–¥–Ω–∞—î—à—Å—è/—Å–∫–ª–∞–¥–µ—à –∫–æ–º–ø–∞–Ω—ñ—é/—Ç–µ–∂ –ø—Ä–∏–π–¥–µ—à}',
                        alternatives: ['–ø—ñ–¥–µ—à –∑—ñ –º–Ω–æ—é', '—Å–∫–ª–∞–¥–µ—à –∫–æ–º–ø–∞–Ω—ñ—é', '—Ç–µ–∂ –ø—Ä–∏–π–¥–µ—à', '–ø—ñ–¥—Ç—Ä–∏–º–∞—î—à –∫–æ–º–ø–∞–Ω—ñ—é'],
                        custom: true
                    },
                    {
                        word: '{–≥–∞—Ä–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —á–∞—Å/–≤—ñ–¥–ø–æ—á–∏—Ç–∏/–≤–µ—Å–µ–ª–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —á–∞—Å}',
                        alternatives: ['–≤–µ—Å–µ–ª–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —á–∞—Å', '–≤—ñ–¥–ø–æ—á–∏—Ç–∏', '–≤—ñ–¥—ñ—Ä–≤–∞—Ç–∏—Å—è', '–ø–æ—Å–º—ñ—è—Ç–∏—Å—è'],
                        custom: true
                    },
                    {
                        word: '{–ú–æ–∂–µ –Ω–∞–≤—ñ—Ç—å –ø–æ–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—å —ñ–∑ –∫–∏–º–æ—Å—å.}',
                        alternatives: [
                            '–ê–ª–µ –Ω–µ –∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—å –Ω—ñ –∑ –∫–∏–º.',
                            '–ú–æ–∂–µ –Ω–∞–≤—ñ—Ç—å –ø–æ–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—å —ñ–∑ –∫–∏–º–æ—Å—å.',
                            '–ú–æ–∂–ª–∏–≤–æ, –ø–æ–∑–Ω–∞–π–æ–º–∏–º–æ—Å—å –∑ –∫–∏–º–æ—Å—å –Ω–æ–≤–∏–º.'
                        ],
                        custom: true
                    }
                ]
            },

            intelligent: {
                name: '–Ü–Ω—Ç–µ–ª—ñ–≥–µ–Ω—Ç–Ω–∏–π',
                icon: 'üé©',
                text: `{–õ—é–±–∏–π –¥—Ä—É–∂–µ}!\n\n{–î–æ–∑–≤–æ–ª—å –∑–∞–ø—Ä–æ—Å–∏—Ç–∏ —Ç–µ–±–µ} –Ω–∞ –≤–µ—á—ñ—Ä —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ–≥–æ —Å—Ç–µ–Ω–¥–∞–ø—É ‚Äî {–∂–∞–Ω—Ä—É, –¥–µ –º–æ–∂–Ω–∞ –ø—Ä–æ—Å—Ç–æ –ø–æ—Å–º—ñ—è—Ç–∏—Å—è –Ω–∞–¥ —Å–æ–±–æ—é —ñ –∂–∏—Ç—Ç—è–º}.\n\n{${smartDateLabel}}, ${eventDate}, –æ ${time} —É –∑–∞—Ç–∏—à–Ω–æ–º—É Theatercaf√© Filmdose (Z√ºlpicher Str. 39, K√∂ln) {–∑–±–µ—Ä—É—Ç—å—Å—è –ª—é–¥–∏, —è–∫—ñ —Ü—ñ–Ω—É—é—Ç—å} –∂–∏–≤–∏–π –≥—É–º–æ—Ä —Ç–∞ —â–∏—Ä–µ —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è.\n\n{–Ø–∫ –∫–∞–∑–∞–≤ –í—ñ–∫—Ç–æ—Ä –ë–æ—Ä–≥–µ: ¬´–°–º—ñ—Ö ‚Äî –Ω–∞–π–∫–æ—Ä–æ—Ç—à–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ –¥–≤–æ–º–∞ –ª—é–¥—å–º–∏¬ª. –ë—É–¥—É —â–∏—Ä–æ —Ä–∞–¥–∏–π, —è–∫—â–æ —Ü—é –≤—ñ–¥—Å—Ç–∞–Ω—å –º–∏ –ø–æ–¥–æ–ª–∞—î–º–æ —Ä–∞–∑–æ–º.}\n\n{–£ –ø—Ä–æ–≥—Ä–∞–º—ñ}: —à—ñ—Å—Ç—å —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö –∫–æ–º—ñ–∫—ñ–≤, {—è–∫—ñ —Å–ø—Ä–æ–±—É—é—Ç—å –≤–∞—Å —Ä–æ–∑—Å–º—ñ—à–∏—Ç–∏}.\n\n–ö–≤–∏—Ç–∫–∏: ${paymentUrl}\n\n{–ó —Ç–µ–ø–ª–æ–º —ñ –Ω–∞–¥—ñ—î—é –Ω–∞ –∑—É—Å—Ç—Ä—ñ—á}.`,
                variations: [
                    {
                        word: `{${smartDateLabel}}`,
                        alternatives: [smartDateLabel, eventDate],
                        custom: true
                    },
                    {
                        word: '{–õ—é–±–∏–π –¥—Ä—É–∂–µ}',
                        alternatives: [
                            '–õ—é–±–∏–π –¥—Ä—É–∂–µ',
                            '–®–∞–Ω–æ–≤–Ω–∏–π –ø—Ä–∏—è—Ç–µ–ª—é',
                            '–î–æ—Ä–æ–≥–∞ –ª—é–¥–∏–Ω–æ',
                            '–í–µ–ª—å–º–∏—à–∞–Ω–æ–≤–Ω–∏–π'
                        ],
                        custom: true
                    },
                    {
                        word: '{–î–æ–∑–≤–æ–ª—å –∑–∞–ø—Ä–æ—Å–∏—Ç–∏ —Ç–µ–±–µ}',
                        alternatives: [
                            '–î–æ–∑–≤–æ–ª—å –∑–∞–ø—Ä–æ—Å–∏—Ç–∏ —Ç–µ–±–µ',
                            '–ú–∞—é —á–µ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∏—Ç–∏ —Ç–µ–±–µ',
                            '–•–æ—á—É –ø–æ–¥—ñ–ª–∏—Ç–∏—Å—è –∑ —Ç–æ–±–æ—é –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—è–º',
                            '–ü—Ä–∏–π–º–∏, –±—É–¥—å –ª–∞—Å–∫–∞, –º–æ—î –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—è'
                        ],
                        custom: true
                    },
                    {
                        word: '{–∂–∞–Ω—Ä—É, –¥–µ –º–æ–∂–Ω–∞ –ø—Ä–æ—Å—Ç–æ –ø–æ—Å–º—ñ—è—Ç–∏—Å—è –Ω–∞–¥ —Å–æ–±–æ—é —ñ –∂–∏—Ç—Ç—è–º}',
                        alternatives: [
                            '–∂–∞–Ω—Ä—É, –¥–µ –º–æ–∂–Ω–∞ –ø—Ä–æ—Å—Ç–æ –ø–æ—Å–º—ñ—è—Ç–∏—Å—è –Ω–∞–¥ —Å–æ–±–æ—é —ñ –∂–∏—Ç—Ç—è–º',
                            '—Ñ–æ—Ä–º–∞—Ç—É, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î —Ç—Ä–æ—Ö–∏ –≤—ñ–¥–≤–æ–ª—ñ–∫—Ç–∏—Å—è –≤—ñ–¥ –±—É–¥–µ–Ω–Ω–æ—Å—Ç—ñ',
                            '—Å–ø–æ—Å–æ–±—É –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤–µ—á—ñ—Ä —É –ø—Ä–∏—î–º–Ω—ñ–π –∫–æ–º–ø–∞–Ω—ñ—ó',
                            '–º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –ø–æ—á—É—Ç–∏ —â–æ—Å—å —Å–º—ñ—à–Ω–µ —Ä—ñ–¥–Ω–æ—é –º–æ–≤–æ—é'
                        ],
                        custom: true
                    },
                    {
                        word: '{–∑–±–µ—Ä—É—Ç—å—Å—è –ª—é–¥–∏, —è–∫—ñ —Ü—ñ–Ω—É—é—Ç—å}',
                        alternatives: [
                            '–∑–±–µ—Ä—É—Ç—å—Å—è –ª—é–¥–∏, —è–∫—ñ —Ü—ñ–Ω—É—é—Ç—å',
                            '–º–∞—Ç–∏–º–µ–º–æ –Ω–∞–≥–æ–¥—É –Ω–∞—Å–æ–ª–æ–¥–∏—Ç–∏—Å—å',
                            '–≤—ñ–¥–±—É–¥–µ—Ç—å—Å—è –≤–µ—á—ñ—Ä –¥–ª—è —Ç–∏—Ö, —Ö—Ç–æ —à—É–∫–∞—î',
                            '—á–µ–∫–∞—Ç–∏–º–µ –∫–∞–º–µ—Ä–Ω–∞ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞'
                        ],
                        custom: true
                    },
                    {
                        word: '{–Ø–∫ –∫–∞–∑–∞–≤ –í—ñ–∫—Ç–æ—Ä –ë–æ—Ä–≥–µ: ¬´–°–º—ñ—Ö ‚Äî –Ω–∞–π–∫–æ—Ä–æ—Ç—à–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ –¥–≤–æ–º–∞ –ª—é–¥—å–º–∏¬ª. –ë—É–¥—É —â–∏—Ä–æ —Ä–∞–¥–∏–π, —è–∫—â–æ —Ü—é –≤—ñ–¥—Å—Ç–∞–Ω—å –º–∏ –ø–æ–¥–æ–ª–∞—î–º–æ —Ä–∞–∑–æ–º.}',
                        alternatives: [
                            '–Ø–∫ –∫–∞–∑–∞–≤ –í—ñ–∫—Ç–æ—Ä –ë–æ—Ä–≥–µ: ¬´–°–º—ñ—Ö ‚Äî –Ω–∞–π–∫–æ—Ä–æ—Ç—à–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ –¥–≤–æ–º–∞ –ª—é–¥—å–º–∏¬ª. –ë—É–¥—É —â–∏—Ä–æ —Ä–∞–¥–∏–π, —è–∫—â–æ —Ü—é –≤—ñ–¥—Å—Ç–∞–Ω—å –º–∏ –ø–æ–¥–æ–ª–∞—î–º–æ —Ä–∞–∑–æ–º.',
                            '–ó–≥–∞–¥—É—é –ß–∞—Ä–ª—ñ –ß–∞–ø–ª—ñ–Ω–∞: ¬´–î–µ–Ω—å –±–µ–∑ —Å–º—ñ—Ö—É ‚Äî –¥–∞—Ä–µ–º–Ω–æ –ø—Ä–æ–∂–∏—Ç–∏–π –¥–µ–Ω—å¬ª. –¢–æ–∂ –Ω–µ –≥–∞–π–º–æ —á–∞—Å—É –¥–∞—Ä–µ–º–Ω–æ.',
                            '–Ø–∫ –º—É–¥—Ä–æ –∑–∞—É–≤–∞–∂–∏–≤ –®–µ–∫—Å–ø—ñ—Ä: ¬´–í–µ—Å–µ–ª–µ —Å–µ—Ä—Ü–µ –∂–∏–≤–µ –¥–æ–≤–≥–æ¬ª. –ü–æ–¥–±–∞–π–º–æ –∂ –ø—Ä–æ –Ω–∞—à—ñ —Å–µ—Ä—Ü—è —Ä–∞–∑–æ–º.',
                            '–ö—ñ–Ω—å –ë–æ–î–∂–µ–∫ —è–∫–æ—Å—å —Å–∫–∞–∑–∞–≤: ¬´–Ø –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π –∑–∞ –≤–ª–∞—Å–Ω–µ —â–∞—Å—Ç—è? –¢–∞ —è –Ω–∞–≤—ñ—Ç—å –∑–∞ —Å–≤—ñ–π —Å–Ω—ñ–¥–∞–Ω–æ–∫ –Ω–µ –º–æ–∂—É –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏¬ª. –¢–æ–º—É –¥–∞–≤–∞–π —Ö–æ—á–∞ –± –∑–∞ –≤–µ—á—ñ—Ä —Å–º—ñ—Ö—É –≤—ñ–∑—å–º–µ–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å —Ä–∞–∑–æ–º.',
                            '–£ –ë–æ–î–∂–µ–∫–∞ —î —Ñ—Ä–∞–∑–∞: ¬´–£ —Ü—å–æ–º—É —Å—Ç—Ä–∞—à–Ω–æ–º—É —Å–≤—ñ—Ç—ñ –≤—Å–µ, —â–æ –º–∏ –º–∞—î–º–æ ‚Äî —Ü–µ –∑–≤\'—è–∑–∫–∏, —è–∫—ñ —Å—Ç–≤–æ—Ä—é—î–º–æ¬ª. –°—Ç–≤–æ—Ä—ñ–º–æ –æ–¥–∏–Ω —Ç–∞–∫–∏–π –∑–≤\'—è–∑–æ–∫ —Ü—å–æ–≥–æ –≤–µ—á–æ—Ä–∞.',
                            '–Ø–∫ –ø–∏—Å–∞–≤ –û—Å—Ç–∞–ø –í–∏—à–Ω—è: ¬´–°–º—ñ–π–º–æ—Å—è! –°–º—ñ—Ö –ø—Ä–æ–¥–æ–≤–∂—É—î –∂–∏—Ç—Ç—è!¬ª –ü—Ä–æ–¥–æ–≤–∂–º–æ –π–æ–≥–æ —Ä–∞–∑–æ–º —Ü—å–æ–≥–æ –≤–µ—á–æ—Ä–∞.',
                            '–ì—Ä–∏–≥–æ—Ä—ñ–π –°–∫–æ–≤–æ—Ä–æ–¥–∞ –≤—á–∏–≤: ¬´–í–µ—Å–µ–ª—ñ—Å—Ç—å ‚Äî —Ü–µ –∑–¥–æ—Ä–æ–≤\'—è –≥–∞—Ä–º–æ–Ω—ñ–π–Ω–æ—ó –¥—É—à—ñ¬ª. –ß–∞—Å –æ–∑–¥–æ—Ä–æ–≤–∏—Ç–∏—Å—è!',

                        ],
                        custom: true
                    },
                    {
                        word: '{–£ –ø—Ä–æ–≥—Ä–∞–º—ñ}',
                        alternatives: [
                            '–£ –ø—Ä–æ–≥—Ä–∞–º—ñ',
                            '–ù–∞ —Å—Ü–µ–Ω—ñ',
                            '–¶—å–æ–≥–æ –≤–µ—á–æ—Ä–∞',
                            '–¢–µ–±–µ —á–µ–∫–∞—é—Ç—å'
                        ],
                        custom: true
                    },
                    {
                        word: '{—è–∫—ñ —Å–ø—Ä–æ–±—É—é—Ç—å –≤–∞—Å —Ä–æ–∑—Å–º—ñ—à–∏—Ç–∏}',
                        alternatives: [
                            '—è–∫—ñ —Å–ø—Ä–æ–±—É—é—Ç—å –≤–∞—Å —Ä–æ–∑—Å–º—ñ—à–∏—Ç–∏',
                            '—è–∫—ñ –∂–∞—Ä—Ç—É–≤–∞—Ç–∏–º—É—Ç—å –ø—Ä–æ –µ–º—ñ–≥—Ä–∞—Ü—ñ—é —Ç–∞ –∂–∏—Ç—Ç—è',
                            '—â–æ —Ä–æ–∑–∫–∞–∂—É—Ç—å –ø—Ä–æ —Å–≤–æ—î –∂–∏—Ç—Ç—è —Ç—É—Ç',
                            '—è–∫—ñ –ø–æ–¥—ñ–ª—è—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è–º–∏'
                        ],
                        custom: true
                    },
                    {
                        word: '{–ó —Ç–µ–ø–ª–æ–º —ñ –Ω–∞–¥—ñ—î—é –Ω–∞ –∑—É—Å—Ç—Ä—ñ—á}',
                        alternatives: [
                            '–ó —Ç–µ–ø–ª–æ–º —ñ –Ω–∞–¥—ñ—î—é –Ω–∞ –∑—É—Å—Ç—Ä—ñ—á',
                            '–¢–≤—ñ–π –¥—Ä—É–≥, —â–æ —á–µ–∫–∞—î –Ω–∞ —Å–ø—ñ–ª—å–Ω–∏–π —Å–º—ñ—Ö',
                            '–ó —â–∏—Ä–æ—é –ø–æ–≤–∞–≥–æ—é —Ç–∞ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è–º',
                            '–î–æ –∑—É—Å—Ç—Ä—ñ—á—ñ —É —Å–≤—ñ—Ç–ª—ñ —Ä–∞–º–ø–∏'
                        ],
                        custom: true
                    }
                ]
            },

            aggressive: {
                name: '–ê–≥—Ä–µ—Å–∏–≤–Ω–∏–π',
                icon: 'üí™',
                text: `–ó–¥–æ—Ä–æ–≤, {–±–∏—á–∞—Ä–∞/–ª–æ—à–∞—Ä–∞/—Å—É—á–∞—Ä–∞}! –Ø –π–¥—É –Ω–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π —Å—Ç–µ–Ω–¥–∞–ø –≤ ${city} {${smartDateLabel}} ${eventDate} –æ ${time}. {–•–æ—á—É –ø–æ–¥–∏–≤–∏—Ç–∏—Å—å, —â–æ –∑–∞ –≥–∞–º–Ω–æ —Ç–∞–º –±—É–¥–µ/–ë—É–ª–æ –± –ø—Ä–∏–∫–æ–ª—å–Ω–æ —Ç–∞–º –∑—É—Å—Ç—Ä—ñ—Ç–∏—Å—å, –≤—ñ–¥–ø–æ—á–∏—Ç–∏ —Ä–∞–∑–æ–º}. {–í–µ—á—ñ—Ä –æ–±—ñ—Ü—è—î –±—É—Ç–∏ —Ö–æ—Ä–æ—à–∏–º/–ù–µ —Ç—É–ø–∏, –π–¥–µ–º–æ —Ä–∞–∑–æ–º}. \n–ö–≤–∏—Ç–∫–∏ —Ç—É—Ç: ${paymentUrl}. \n–ù–µ –ø—Ä–∏–π—à–æ–≤ - –ø—Ä–æ—ó–±–∞–≤!`,
                variations: [
                    {
                        word: `{${smartDateLabel}}`,
                        alternatives: [smartDateLabel, eventDate],
                        custom: true
                    },
                    {
                        word: '{–±–∏—á–∞—Ä–∞/–ª–æ—à–∞—Ä–∞/—Å—É—á–∞—Ä–∞}',
                        alternatives: ['–±–∏—á–∞—Ä–∞', '–±–æ–º–∂–∞—Ä–∞', '–ª–æ—à–∞—Ä–∞', '–±—Ä–∞—Ç–∞–Ω', '—á—É–≤–∞–∫', '—Å—É—á–∞—Ä–∞', '—É–π–æ–±–æ–∫', '–¥—î–≥–∞–Ω'],
                        custom: true
                    },
                    {
                        word: '{–•–æ—á—É –ø–æ–¥–∏–≤–∏—Ç–∏—Å—å, —â–æ –∑–∞ –≥–∞–º–Ω–æ —Ç–∞–º –±—É–¥–µ/–ë—É–ª–æ –± –ø—Ä–∏–∫–æ–ª—å–Ω–æ —Ç–∞–º –∑—É—Å—Ç—Ä—ñ—Ç–∏—Å—å, –≤—ñ–¥–ø–æ—á–∏—Ç–∏ —Ä–∞–∑–æ–º}',
                        alternatives: [
                            '–•–æ—á—É –ø–æ–¥–∏–≤–∏—Ç–∏—Å—å, —â–æ –∑–∞ –≥–∞–º–Ω–æ —Ç–∞–º –±—É–¥–µ',
                            '–ë—É–ª–æ –± –ø—Ä–∏–∫–æ–ª—å–Ω–æ —Ç–∞–º –∑—É—Å—Ç—Ä—ñ—Ç–∏—Å—å, –≤—ñ–¥–ø–æ—á–∏—Ç–∏ —Ä–∞–∑–æ–º',
                            '–¢—Ä–µ–±–∞ –π—Ç–∏, –±–æ –≤—Å—ñ –π–¥—É—Ç—å'
                        ],
                        custom: true
                    },
                    {
                        word: '{–í–µ—á—ñ—Ä –æ–±—ñ—Ü—è—î –±—É—Ç–∏ —Ö–æ—Ä–æ—à–∏–º/–ù–µ —Ç—É–ø–∏, –π–¥–µ–º–æ —Ä–∞–∑–æ–º}',
                        alternatives: [
                            '–Ø –≤–ø–µ–≤–Ω–µ–Ω–∏–π —â–æ –¥–æ–±—Ä–µ –ø—Ä–æ–≤–µ–¥—É —Ç–∞–º —á–∞—Å, –∞–ª–µ –∑ —Ç–æ–±–æ—é –±—É–¥–µ –∫—Ä–∞—â–µ',
                            '–î—É–º–∞—é –±—É–¥–µ –≤–µ—Å–µ–ª–æ, —Ç–æ–∂ –¥–∞–≤–∞–π –Ω–µ –ª—ñ–Ω—É–π—Å—è',
                            '–ù–µ —Ç—É–ø–∏, –π–¥–µ–º–æ —Ä–∞–∑–æ–º'
                        ],
                        custom: true
                    }
                ]
            },

            nerdy: {
                name: '–ë–æ—Ç–∞–Ω—Å—å–∫–∏–π',
                icon: 'ü§ì',
                text: `{–®–∞–Ω–æ–≤–Ω–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–Ω–∏–∫—É –≤–∏–¥—É Homo sapiens}!\n\n{–ó–≥—ñ–¥–Ω–æ –∑ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è–º–∏} —É –≥–∞–ª—É–∑—ñ –≥–µ–ª–æ—Ç–æ–ª–æ–≥—ñ—ó (–Ω–∞—É–∫–∏ –ø—Ä–æ —Å–º—ñ—Ö), {–∫–æ–ª–µ–∫—Ç–∏–≤–Ω–∏–π –ø–µ—Ä–µ–≥–ª—è–¥ –∫–æ–º–µ–¥—ñ–π–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É} –∞–∫—Ç–∏–≤—É—î nucleus accumbens —Ç–∞ {—Å—Ç–∏–º—É–ª—é—î –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–Ω—è} –µ–Ω–¥–æ–≥–µ–Ω–Ω–∏—Ö –æ–ø—ñ–æ—ó–¥—ñ–≤ —É —Ç–∞–ª–∞–º—É—Å—ñ —Ç–∞ –ø–µ—Ä–µ–¥–Ω—ñ–π —ñ–Ω—Å—É–ª—ñ. {–§–∞–∫—Ç: –ª—é–¥–∏ —Å–º—ñ—é—Ç—å—Å—è —É 30 —Ä–∞–∑—ñ–≤ —á–∞—Å—Ç—ñ—à–µ –≤ –∫–æ–º–ø–∞–Ω—ñ—ó}, –Ω—ñ–∂ –Ω–∞ —Å–∞–º–æ—Ç—ñ (Provine, 2000).\n\n{${smartDateLabel}}, ${eventDate}, –æ ${time} –∑–∞ –∞–¥—Ä–µ—Å–æ—é Z√ºlpicher Str. 39, 50674 K√∂ln (Theatercaf√© Filmdose) –≤—ñ–¥–±—É–¥–µ—Ç—å—Å—è {–ø–æ–ª—å–æ–≤–∏–π –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç} –∑ —ñ–Ω–¥—É–∫—Ü—ñ—ó –ø–æ–∑–∏—Ç–∏–≤–Ω–∏—Ö –µ–º–æ—Ü—ñ–π–Ω–∏—Ö —Å—Ç–∞–Ω—ñ–≤ (n ‚âà 100 —Å—É–±'—î–∫—Ç—ñ–≤).\n\n–ú–æ—è {—Ä–æ–±–æ—á–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞}: H‚ÇÅ: —Ç–≤–æ—è –ø—Ä–∏—Å—É—Ç–Ω—ñ—Å—Ç—å {—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –∑–Ω–∞—á—É—â–µ} (p < 0.001) –ø–æ–∫—Ä–∞—â–∏—Ç—å –º—ñ–π —Å—É–±'—î–∫—Ç–∏–≤–Ω–∏–π –¥–æ—Å–≤—ñ–¥ –∑–∞—Ö–æ–¥—É. {–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –µ—Ñ–µ–∫—Ç—É: –≤–µ–ª–∏–∫–∏–π}.\n\n–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—É –≥—Ä—É–ø—É: ${paymentUrl}\n\n{P.S. –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ –ø–æ–±—ñ—á–Ω—ñ –µ—Ñ–µ–∫—Ç–∏}: –±—ñ–ª—å —É –º'—è–∑–∞—Ö –∂–∏–≤–æ—Ç–∞, —Å–ª—å–æ–∑–∏ (–µ—Ç—ñ–æ–ª–æ–≥—ñ—è: —Ä–∞–¥—ñ—Å—Ç—å), —Ç–∞ —Å–ø–æ–Ω—Ç–∞–Ω–Ω–µ –±–∞–∂–∞–Ω–Ω—è –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç.`,
                variations: [
                    {
                        word: `{${smartDateLabel}}`,
                        alternatives: [smartDateLabel, eventDate],
                        custom: true
                    },
                    {
                        word: '{–®–∞–Ω–æ–≤–Ω–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–Ω–∏–∫—É –≤–∏–¥—É Homo sapiens}',
                        alternatives: [
                            '–®–∞–Ω–æ–≤–Ω–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–Ω–∏–∫—É –≤–∏–¥—É Homo sapiens',
                            '–í–µ–ª—å–º–∏—à–∞–Ω–æ–≤–Ω–∏–π –ø—Ä–∏–º–∞—Ç–µ —Ä–æ–¥–∏–Ω–∏ Hominidae',
                            '–î–æ—Ä–æ–≥–∏–π –∫–æ–ª–µ–≥–æ –ø–æ –±—ñ–æ—Å—Ñ–µ—Ä—ñ',
                            '–í–∏—Å–æ–∫–æ–ø–æ–≤–∞–∂–Ω–∏–π –Ω–æ—Å—ñ—é —Å–≤—ñ–¥–æ–º–æ—Å—Ç—ñ'
                        ],
                        custom: true
                    },
                    {
                        word: '{–ó–≥—ñ–¥–Ω–æ –∑ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è–º–∏}',
                        alternatives: [
                            '–ó–≥—ñ–¥–Ω–æ –∑ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è–º–∏',
                            '–ó–∞ –¥–∞–Ω–∏–º–∏ –Ω–µ–π—Ä–æ–≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ–π–Ω–∏—Ö –¥–æ—Å–ª—ñ–¥–∂–µ–Ω—å',
                            '–Ø–∫ —Å–≤—ñ–¥—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ü–ï–¢-—Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è',
                            '–í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π —É Journal of Neuroscience'
                        ],
                        custom: true
                    },
                    {
                        word: '{–∫–æ–ª–µ–∫—Ç–∏–≤–Ω–∏–π –ø–µ—Ä–µ–≥–ª—è–¥ –∫–æ–º–µ–¥—ñ–π–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É}',
                        alternatives: [
                            '–∫–æ–ª–µ–∫—Ç–∏–≤–Ω–∏–π –ø–µ—Ä–µ–≥–ª—è–¥ –∫–æ–º–µ–¥—ñ–π–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É',
                            '–≥—Ä—É–ø–æ–≤–∞ –µ–∫—Å–ø–æ–∑–∏—Ü—ñ—è –¥–æ –≥—É–º–æ—Ä–∏—Å—Ç–∏—á–Ω–∏—Ö —Å—Ç–∏–º—É–ª—ñ–≤',
                            '—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–∞ —Ä–µ—Ü–µ–ø—Ü—ñ—è –∂–∞—Ä—Ç—ñ–≤–ª–∏–≤–æ–≥–æ –º–∞—Ç–µ—Ä—ñ–∞–ª—É',
                            '—Å–ø—ñ–ª—å–Ω–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è —Å–∞—Ç–∏—Ä–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É'
                        ],
                        custom: true
                    },
                    {
                        word: '{—Å—Ç–∏–º—É–ª—é—î –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–Ω—è}',
                        alternatives: [
                            '—Å—Ç–∏–º—É–ª—é—î –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–Ω—è',
                            '–ø–æ—Ç–µ–Ω—Ü—ñ—é—î —Å–µ–∫—Ä–µ—Ü—ñ—é',
                            '—ñ–Ω–¥—É–∫—É—î —Å–∏–Ω—Ç–µ–∑',
                            '–∫–∞—Ç–∞–ª—ñ–∑—É—î –ø—Ä–æ–¥—É–∫—Ü—ñ—é'
                        ],
                        custom: true
                    },
                    {
                        word: '{–§–∞–∫—Ç: –ª—é–¥–∏ —Å–º—ñ—é—Ç—å—Å—è —É 30 —Ä–∞–∑—ñ–≤ —á–∞—Å—Ç—ñ—à–µ –≤ –∫–æ–º–ø–∞–Ω—ñ—ó}',
                        alternatives: [
                            '–§–∞–∫—Ç: –ª—é–¥–∏ —Å–º—ñ—é—Ç—å—Å—è —É 30 —Ä–∞–∑—ñ–≤ —á–∞—Å—Ç—ñ—à–µ –≤ –∫–æ–º–ø–∞–Ω—ñ—ó',
                            '–î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –ø–æ–∫–∞–∑—É—é—Ç—å: —Å–æ—Ü—ñ–∞–ª—å–Ω–∏–π —Å–º—ñ—Ö —É 30 —Ä–∞–∑—ñ–≤ —ñ–º–æ–≤—ñ—Ä–Ω—ñ—à–∏–π',
                            '–ï–º–ø—ñ—Ä–∏—á–Ω–∏–π —Ñ–∞–∫—Ç: –≥—Ä—É–ø–æ–≤–∏–π —Å–º—ñ—Ö –¥–æ–º—ñ–Ω—É—î –Ω–∞–¥ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–º',
                            '–ó–∞ –¥–∞–Ω–∏–º–∏ Provine: —Å–æ—Ü—ñ–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫—Ä–∏—Ç–∏—á–Ω–∏–π –¥–ª—è —Å–º—ñ—Ö—É'
                        ],
                        custom: true
                    },
                    {
                        word: '{–ø–æ–ª—å–æ–≤–∏–π –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç}',
                        alternatives: [
                            '–ø–æ–ª—å–æ–≤–∏–π –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç',
                            '–Ω–∞—Ç—É—Ä–∞–ª—ñ—Å—Ç–∏—á–Ω–µ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è',
                            '–∫–≤–∞–∑—ñ–µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç',
                            '–ø—Ä–∏–∫–ª–∞–¥–Ω–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è'
                        ],
                        custom: true
                    },
                    {
                        word: '{—Ä–æ–±–æ—á–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞}',
                        alternatives: [
                            '—Ä–æ–±–æ—á–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞',
                            '–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞',
                            '–µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞',
                            '–∞–ø—Ä—ñ–æ—Ä–Ω–µ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è'
                        ],
                        custom: true
                    },
                    {
                        word: '{—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –∑–Ω–∞—á—É—â–µ}',
                        alternatives: [
                            '—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –∑–Ω–∞—á—É—â–µ',
                            '–∑ –≤–∏—Å–æ–∫–æ—é –¥–æ—Å—Ç–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é',
                            '–ø—Ä–∏ Œ± = 0.05',
                            '–∑ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ—é –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é –ø–æ–º–∏–ª–∫–∏ –Ü —Ä–æ–¥—É'
                        ],
                        custom: true
                    },
                    {
                        word: '{–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –µ—Ñ–µ–∫—Ç—É: –≤–µ–ª–∏–∫–∏–π}',
                        alternatives: [
                            '–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –µ—Ñ–µ–∫—Ç—É: –≤–µ–ª–∏–∫–∏–π',
                            '–î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –Ω–µ –≤–∫–ª—é—á–∞—Ç–∏–º–µ –Ω—É–ª—å',
                            '–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –ö–æ–µ–Ω–∞ d > 0.8',
                            '–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å —Ç–µ—Å—Ç—É –Ω–∞–±–ª–∏–∂–∞—î—Ç—å—Å—è –¥–æ 1'
                        ],
                        custom: true
                    },
                    {
                        word: '{P.S. –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ –ø–æ–±—ñ—á–Ω—ñ –µ—Ñ–µ–∫—Ç–∏}',
                        alternatives: [
                            'P.S. –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ –ø–æ–±—ñ—á–Ω—ñ –µ—Ñ–µ–∫—Ç–∏',
                            '–£–≤–∞–≥–∞: –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω—ñ –Ω–µ–±–∞–∂–∞–Ω—ñ —Ä–µ–∞–∫—Ü—ñ—ó',
                            'NB: –ø—Ä–æ—Ñ—ñ–ª—å –±–µ–∑–ø–µ–∫–∏ –≤–∫–ª—é—á–∞—î',
                            '–ó–∞—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è: –º–æ–∂–ª–∏–≤—ñ –ø–æ–±—ñ—á–Ω—ñ —è–≤–∏—â–∞'
                        ],
                        custom: true
                    }
                ]
            },

            corporate: {
                name: '–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∏–π',
                icon: 'üëî',
                text: `{–ú–ï–ú–û–†–ê–ù–î–£–ú}\n\n–î–æ: {–®–∞–Ω–æ–≤–Ω–∏–π –∫–æ–ª–µ–≥–æ/–∫–æ–ª–µ–∂–∞–Ω–∫–æ}\n–í—ñ–¥: –î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç —Ä–æ–∑–≤–∞–≥ —Ç–∞ –¥–æ–±—Ä–æ–±—É—Ç—É\n–¢–µ–º–∞: {–ó–∞–ø—Ä–æ—à–µ–Ω–Ω—è –Ω–∞ —Ç—ñ–º–±—ñ–ª–¥—ñ–Ω–≥–æ–≤–∏–π –∑–∞—Ö—ñ–¥}\n\n{–¶–∏–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º –æ—Ñ—ñ—Ü—ñ–π–Ω–æ —ñ–Ω—Ñ–æ—Ä–º—É—é} –ø—Ä–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è {—Å—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω–æ–≥–æ –∑–∞—Ö–æ–¥—É} –∑ {–æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —Ä—ñ–≤–Ω—è –∑–∞–¥–æ–≤–æ–ª–µ–Ω–æ—Å—Ç—ñ} —Ç–∞ —Ä–æ–∑–≤–∏—Ç–∫—É –∫–æ–º—É–Ω—ñ–∫–∞—Ç–∏–≤–Ω–∏—Ö –Ω–∞–≤–∏—á–æ–∫.\n\n{–î–µ—Ç–∞–ª—ñ}:\n‚Ä¢ –î–∞—Ç–∞: {${smartDateLabel}}, ${eventDate}\n‚Ä¢ –ß–∞—Å: ${time}\n‚Ä¢ –õ–æ–∫–∞—Ü—ñ—è: Theatercaf√© Filmdose, Z√ºlpicher Str. 39, 50674 K√∂ln\n‚Ä¢ –§–æ—Ä–º–∞—Ç: –£–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π —Å—Ç–µ–Ω–¥–∞–ø-–∫–æ–Ω—Ü–µ—Ä—Ç\n‚Ä¢ –î—Ä–µ—Å-–∫–æ–¥: {–í—ñ–ª—å–Ω–∏–π}\n\n{–û—á—ñ–∫—É–≤–∞–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ}:\n‚Äî –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è —Ä—ñ–≤–Ω—è –µ–Ω–¥–æ—Ä—Ñ—ñ–Ω—ñ–≤ –Ω–∞ 200%\n‚Äî {–°–∏–Ω–µ—Ä–≥—ñ—è —Å–º—ñ—Ö—É} –≤ –∫–æ–º–∞–Ω–¥—ñ\n‚Äî –ù–µ—Ç–≤–æ—Ä–∫—ñ–Ω–≥ —É –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ñ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä—ñ\n‚Äî {–í–∑–∞—î–º–Ω–∞ –≤–∏–≥–æ–¥–∞ –¥–ª—è –≤—Å—ñ—Ö —É—á–∞—Å–Ω–∏–∫—ñ–≤}\n\n–ü—Ä–æ—Å–∏–º–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ —É—á–∞—Å—Ç—å: ${paymentUrl}\n\n{–ü–ª–∞–Ω –¥—ñ–π}: –ø—Ä–∏–¥–±–∞—Ç–∏ –∫–≤–∏—Ç–æ–∫ ‚Üí –∑'—è–≤–∏—Ç–∏—Å—è ‚Üí —Å–º—ñ—è—Ç–∏—Å—è ‚Üí {–æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è}.\n\n{–ó –ø–æ–≤–∞–≥–æ—é —Ç–∞ –Ω–∞–π–∫—Ä–∞—â–∏–º–∏ –ø–æ–±–∞–∂–∞–Ω–Ω—è–º–∏ —â–æ–¥–æ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –≤–∞—à–∏—Ö –æ—Å–æ–±–∏—Å—Ç–∏—Ö —Ü—ñ–ª–µ–π}.`,
                variations: [
                    {
                        word: `{${smartDateLabel}}`,
                        alternatives: [smartDateLabel, eventDate],
                        custom: true
                    },
                    {
                        word: '{–ú–ï–ú–û–†–ê–ù–î–£–ú}',
                        alternatives: [
                            '–ú–ï–ú–û–†–ê–ù–î–£–ú',
                            '–í–ù–£–¢–†–Ü–®–ù–Ø –ö–û–ú–£–ù–Ü–ö–ê–¶–Ü–Ø',
                            '–°–õ–£–ñ–ë–û–í–ê –ó–ê–ü–ò–°–ö–ê',
                            '–û–§–Ü–¶–Ü–ô–ù–ï –ó–ê–ü–†–û–®–ï–ù–ù–Ø'
                        ],
                        custom: true
                    },
                    {
                        word: '{–®–∞–Ω–æ–≤–Ω–∏–π –∫–æ–ª–µ–≥–æ/–∫–æ–ª–µ–∂–∞–Ω–∫–æ}',
                        alternatives: [
                            '–®–∞–Ω–æ–≤–Ω–∏–π –∫–æ–ª–µ–≥–æ/–∫–æ–ª–µ–∂–∞–Ω–∫–æ',
                            '–í–µ–ª—å–º–∏—à–∞–Ω–æ–≤–Ω–∏–π —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—É',
                            '–£—á–∞—Å–Ω–∏–∫—É –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ—ó –µ–∫–æ—Å–∏—Å—Ç–µ–º–∏',
                            '–¶—ñ–Ω–Ω–∏–π —á–ª–µ–Ωe –∫–æ–º–∞–Ω–¥–∏'
                        ],
                        custom: true
                    },
                    {
                        word: '{–ó–∞–ø—Ä–æ—à–µ–Ω–Ω—è –Ω–∞ —Ç—ñ–º–±—ñ–ª–¥—ñ–Ω–≥–æ–≤–∏–π –∑–∞—Ö—ñ–¥}',
                        alternatives: [
                            '–ó–∞–ø—Ä–æ—à–µ–Ω–Ω—è –Ω–∞ —Ç—ñ–º–±—ñ–ª–¥—ñ–Ω–≥–æ–≤–∏–π –∑–∞—Ö—ñ–¥',
                            'Re: –Ü–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–∞ –∑ –∫–æ–º–∞–Ω–¥–æ—É—Ç–≤–æ—Ä–µ–Ω–Ω—è Q4',
                            '–ó–∞–ø—Ä–æ—à–µ–Ω–Ω—è: –ú—ñ–∂—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –∑–∞—Ö—ñ–¥',
                            '–¢–ï–†–ú–Ü–ù–û–í–û: –°–µ—Å—ñ—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —â–∞—Å—Ç—è'
                        ],
                        custom: true
                    },
                    {
                        word: '{–¶–∏–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º –æ—Ñ—ñ—Ü—ñ–π–Ω–æ —ñ–Ω—Ñ–æ—Ä–º—É—é}',
                        alternatives: [
                            '–¶–∏–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º –æ—Ñ—ñ—Ü—ñ–π–Ω–æ —ñ–Ω—Ñ–æ—Ä–º—É—é',
                            '–í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –Ω–∞—à–æ—ó –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó —Ä–æ–∑–º–æ–≤–∏',
                            '–£ –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–∏ —â–∞—Å—Ç—è',
                            '–ó–≥—ñ–¥–Ω–æ –∑—ñ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—î—é –¥–æ–±—Ä–æ–±—É—Ç—É'
                        ],
                        custom: true
                    },
                    {
                        word: '{—Å—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω–æ–≥–æ –∑–∞—Ö–æ–¥—É}',
                        alternatives: [
                            '—Å—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω–æ–≥–æ –∑–∞—Ö–æ–¥—É',
                            '–ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ –∑–∞—Ö–æ–¥—É',
                            '–∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ',
                            '–∫–ª—é—á–æ–≤–æ—ó —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–∏'
                        ],
                        custom: true
                    },
                    {
                        word: '{–æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —Ä—ñ–≤–Ω—è –∑–∞–¥–æ–≤–æ–ª–µ–Ω–æ—Å—Ç—ñ}',
                        alternatives: [
                            '–æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —Ä—ñ–≤–Ω—è –∑–∞–¥–æ–≤–æ–ª–µ–Ω–æ—Å—Ç—ñ',
                            '–º–∞–∫—Å–∏–º—ñ–∑–∞—Ü—ñ—ó —â–∞—Å—Ç—è –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤',
                            '–≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –ø—ñ–¥—Ö–æ–¥—É ¬´–≤–µ—Å–µ–ª–æ—â—ñ –Ω–∞—Å–∞–º–ø–µ—Ä–µ–¥¬ª',
                            '—Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –º–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—ó —Ä–∞–¥–æ—Å—Ç—ñ'
                        ],
                        custom: true
                    },
                    {
                        word: '{–î–µ—Ç–∞–ª—ñ}',
                        alternatives: [
                            '–î–µ—Ç–∞–ª—ñ',
                            '–ö–æ—Ä–æ—Ç–∫–∏–π –æ–≥–ª—è–¥',
                            '–ö–ª—é—á–æ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏',
                            '–ü–æ—Ä—è–¥–æ–∫ –¥–µ–Ω–Ω–∏–π'
                        ],
                        custom: true
                    },
                    {
                        word: '{–í—ñ–ª—å–Ω–∏–π}',
                        alternatives: [
                            '–í—ñ–ª—å–Ω–∏–π',
                            '–ù–∞–ø—ñ–≤–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π',
                            '–°—Ç–∞—Ä—Ç–∞–ø-—à–∏–∫',
                            '–©–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Ä–∞–¥—ñ—Å—Ç—å'
                        ],
                        custom: true
                    },
                    {
                        word: '{–û—á—ñ–∫—É–≤–∞–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ}',
                        alternatives: [
                            '–û—á—ñ–∫—É–≤–∞–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ',
                            '–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø—ñ—Ö—É',
                            '–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω—ñ—Å—Ç—å –µ–º–æ—Ü—ñ–π',
                            '–ü—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏'
                        ],
                        custom: true
                    },
                    {
                        word: '{–°–∏–Ω–µ—Ä–≥—ñ—è —Å–º—ñ—Ö—É}',
                        alternatives: [
                            '–°–∏–Ω–µ—Ä–≥—ñ—è —Å–º—ñ—Ö—É',
                            '–£–∑–≥–æ–¥–∂–µ–Ω—ñ—Å—Ç—å –≥—É–º–æ—Ä—É',
                            '–ö–æ–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∏–π —Ö—ñ—Ö—ñ–∫',
                            '–ö–æ–º–∞–Ω–¥–Ω–∏–π —Ä–µ–≥—ñ—Ç'
                        ],
                        custom: true
                    },
                    {
                        word: '{–í–∑–∞—î–º–Ω–∞ –≤–∏–≥–æ–¥–∞ –¥–ª—è –≤—Å—ñ—Ö —É—á–∞—Å–Ω–∏–∫—ñ–≤}',
                        alternatives: [
                            '–í–∑–∞—î–º–Ω–∞ –≤–∏–≥–æ–¥–∞ –¥–ª—è –≤—Å—ñ—Ö —É—á–∞—Å–Ω–∏–∫—ñ–≤',
                            '–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∏–π –¥–æ—Å–≤—ñ–¥ –≤–µ—Å–µ–ª–æ—â—ñ–≤',
                            '–°—Ç—ñ–π–∫–∞ –º–æ–¥–µ–ª—å —â–∞—Å—Ç—è',
                            '–ü–æ–¥–æ–ª–∞–Ω–Ω—è –Ω—É–¥—å–≥–∏'
                        ],
                        custom: true
                    },
                    {
                        word: '{–ü–ª–∞–Ω –¥—ñ–π}',
                        alternatives: [
                            '–ü–ª–∞–Ω –¥—ñ–π',
                            '–ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏',
                            '–î–æ—Ä–æ–∂–Ω—è –∫–∞—Ä—Ç–∞',
                            '–ü–ª–∞–Ω –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è'
                        ],
                        custom: true
                    },
                    {
                        word: '{–æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è}',
                        alternatives: [
                            '–æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è',
                            '–≤–∏–π—Ç–∏ –∑–∞ —Ä–∞–º–∫–∏ –∑–æ–Ω–∏ –∫–æ–º—Ñ–æ—Ä—Ç—É',
                            '–≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å',
                            '—Ä–æ–∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Ä–∞–¥–æ—Å—Ç—ñ'
                        ],
                        custom: true
                    },
                    {
                        word: '{–ó –ø–æ–≤–∞–≥–æ—é —Ç–∞ –Ω–∞–π–∫—Ä–∞—â–∏–º–∏ –ø–æ–±–∞–∂–∞–Ω–Ω—è–º–∏ —â–æ–¥–æ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –≤–∞—à–∏—Ö –æ—Å–æ–±–∏—Å—Ç–∏—Ö —Ü—ñ–ª–µ–π}',
                        alternatives: [
                            '–ó –ø–æ–≤–∞–≥–æ—é —Ç–∞ –Ω–∞–π–∫—Ä–∞—â–∏–º–∏ –ø–æ–±–∞–∂–∞–Ω–Ω—è–º–∏ —â–æ–¥–æ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –≤–∞—à–∏—Ö –æ—Å–æ–±–∏—Å—Ç–∏—Ö —Ü—ñ–ª–µ–π',
                            '–ó –Ω–∞–π–∫—Ä–∞—â–∏–º–∏ –ø–æ–±–∞–∂–∞–Ω–Ω—è–º–∏ —Ç–∞ –≥–∞—Ä–Ω–∏–º –Ω–∞—Å—Ç—Ä–æ—î–º',
                            '–ü–æ–≤–µ—Ä–Ω–µ–º–æ—Å—å –¥–æ —Ü—å–æ–≥–æ –Ω–∞–π–±–ª–∏–∂—á–∏–º —á–∞—Å–æ–º',
                            '–ß–µ–∫–∞—é –Ω–∞ –æ—Å–æ–±–∏—Å—Ç—É –∑—É—Å—Ç—Ä—ñ—á'
                        ],
                        custom: true
                    }
                ]
            }
        };
    }

    class InvitationCreator {
        constructor() {
            this.templates = buildTemplates();
            this.currentStyle = 'casual';
            this.currentText = '';
            this.selectedWords = {};
            this.modal = null;
        }

        open() {
            this.createModal();
            this.render();
            document.body.style.overflow = 'hidden';

            // Track modal open
            trackEvent('invitation_modal_open');
        }

        close() {
            if (this.modal) {
                this.modal.style.animation = 'fadeOut 0.3s ease-out';
                setTimeout(() => {
                    if (this.modal && this.modal.parentNode) {
                        this.modal.parentNode.removeChild(this.modal);
                    }
                    document.body.style.overflow = '';
                }, 300);
            }
        }

        createModal() {
            const emoji = invConfig.emoji || '‚ú®';
            const gradient = invConfig.themeGradient || 'linear-gradient(135deg, #5B9BD5, #F5D76E)';

            this.modal = document.createElement('div');
            this.modal.id = 'invitation-modal';
            this.modal.innerHTML = `
                <style>
                    #invitation-modal {
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0, 0, 0, 0.7);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        z-index: 10000;
                        padding: 20px;
                        animation: invFadeIn 0.3s ease-out;
                        backdrop-filter: blur(5px);
                    }

                    @keyframes invFadeIn {
                        from { opacity: 0; }
                        to { opacity: 1; }
                    }

                    @keyframes invFadeOut {
                        from { opacity: 1; }
                        to { opacity: 0; }
                    }

                    .invitation-content {
                        background: white;
                        border-radius: 20px;
                        max-width: 700px;
                        width: 100%;
                        max-height: 90vh;
                        overflow-y: auto;
                        padding: 40px;
                        position: relative;
                        animation: invSlideUp 0.4s ease-out;
                    }

                    @keyframes invSlideUp {
                        from {
                            transform: translateY(50px);
                            opacity: 0;
                        }
                        to {
                            transform: translateY(0);
                            opacity: 1;
                        }
                    }

                    .invitation-close {
                        position: absolute;
                        top: 15px;
                        right: 15px;
                        background: none;
                        border: none;
                        font-size: 2rem;
                        cursor: pointer;
                        color: #6C757D;
                        transition: all 0.3s ease;
                        width: 40px;
                        height: 40px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        border-radius: 50%;
                    }

                    .invitation-close:hover {
                        background: #E8F3FC;
                        color: #5B9BD5;
                        transform: rotate(90deg);
                    }

                    .invitation-header {
                        text-align: center;
                        margin-bottom: 30px;
                    }

                    .invitation-header h2 {
                        font-family: 'Caveat', cursive;
                        font-size: 2.5rem;
                        background: ${gradient};
                        -webkit-background-clip: text;
                        -webkit-text-fill-color: transparent;
                        margin-bottom: 10px;
                    }

                    .invitation-header p {
                        color: #6C757D;
                        font-size: 1rem;
                    }

                    .style-selector {
                        display: flex;
                        gap: 10px;
                        margin-bottom: 30px;
                        justify-content: center;
                        flex-wrap: wrap;
                    }

                    .style-btn {
                        flex: 1;
                        min-width: 150px;
                        padding: 15px 20px;
                        border: 2px solid #E8F3FC;
                        background: white;
                        border-radius: 12px;
                        font-family: 'Montserrat', sans-serif;
                        font-size: 1rem;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 8px;
                    }

                    .style-btn:hover {
                        border-color: #5B9BD5;
                        transform: translateY(-2px);
                        box-shadow: 0 4px 12px rgba(91, 155, 213, 0.2);
                    }

                    .style-btn.active {
                        border-color: #5B9BD5;
                        background: linear-gradient(135deg, #E8F3FC, #F5F5F5);
                        box-shadow: 0 4px 12px rgba(91, 155, 213, 0.3);
                    }

                    .text-preview {
                        background: linear-gradient(135deg, #E8F3FC, #FAFCFF);
                        padding: 25px;
                        border-radius: 16px;
                        margin-bottom: 25px;
                        border: 2px solid #5B9BD5;
                        min-height: 200px;
                        font-size: 1.05rem;
                        line-height: 1.8;
                        color: #2C3E50;
                        position: relative;
                    }

                    .editable-word {
                        position: relative;
                        cursor: pointer;
                        font-weight: 600;
                        color: #5B9BD5;
                        border-bottom: 2px dashed #5B9BD5;
                        padding: 2px 4px;
                        transition: all 0.2s ease;
                    }

                    .editable-word:hover {
                        background: rgba(91, 155, 213, 0.1);
                        border-bottom-style: solid;
                    }

                    .alternatives-popup {
                        position: fixed;
                        background: white;
                        border: 2px solid #5B9BD5;
                        border-radius: 12px;
                        padding: 10px;
                        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
                        z-index: 10001;
                        min-width: 200px;
                        max-width: 300px;
                        animation: popupSlide 0.2s ease-out;
                    }

                    @keyframes popupSlide {
                        from {
                            opacity: 0;
                            transform: translateY(-10px);
                        }
                        to {
                            opacity: 1;
                            transform: translateY(0);
                        }
                    }

                    .alternative-option {
                        padding: 10px 15px;
                        cursor: pointer;
                        border-radius: 8px;
                        transition: all 0.2s ease;
                        font-size: 0.95rem;
                        margin-bottom: 5px;
                    }

                    .alternative-option:last-child {
                        margin-bottom: 0;
                    }

                    .alternative-option:hover {
                        background: #E8F3FC;
                        color: #5B9BD5;
                    }

                    .alternative-option.active {
                        background: #5B9BD5;
                        color: white;
                    }

                    .custom-input-section {
                        padding-top: 10px;
                        border-top: 1px solid #E8F3FC;
                        margin-top: 5px;
                    }

                    .custom-input {
                        width: 100%;
                        padding: 8px 12px;
                        border: 1px solid #E8F3FC;
                        border-radius: 6px;
                        font-family: 'Montserrat', sans-serif;
                        font-size: 0.9rem;
                        margin-bottom: 5px;
                    }

                    .custom-input:focus {
                        outline: none;
                        border-color: #5B9BD5;
                    }

                    .custom-btn {
                        width: 100%;
                        padding: 6px 12px;
                        background: #5B9BD5;
                        color: white;
                        border: none;
                        border-radius: 6px;
                        font-family: 'Montserrat', sans-serif;
                        font-size: 0.85rem;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.2s ease;
                    }

                    .custom-btn:hover {
                        background: #7DB3E8;
                    }

                    .send-buttons {
                        display: flex;
                        gap: 15px;
                    }

                    .send-btn {
                        flex: 1;
                        padding: 15px 25px;
                        border: none;
                        border-radius: 12px;
                        font-family: 'Montserrat', sans-serif;
                        font-size: 1rem;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 8px;
                        color: white;
                    }

                    .send-btn.telegram {
                        background: #0088cc;
                        box-shadow: 0 4px 12px rgba(0, 136, 204, 0.3);
                    }

                    .send-btn.telegram:hover {
                        background: #006699;
                        transform: translateY(-2px);
                        box-shadow: 0 6px 16px rgba(0, 136, 204, 0.4);
                    }

                    .send-btn.whatsapp {
                        background: #25D366;
                        box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
                    }

                    .send-btn.whatsapp:hover {
                        background: #20ba5a;
                        transform: translateY(-2px);
                        box-shadow: 0 6px 16px rgba(37, 211, 102, 0.4);
                    }

                    .hint-text {
                        text-align: center;
                        color: #6C757D;
                        font-size: 0.9rem;
                        margin-bottom: 20px;
                        font-style: italic;
                    }

                    @media (max-width: 768px) {
                        .invitation-content {
                            padding: 30px 20px;
                            max-height: 95vh;
                        }

                        .invitation-header h2 {
                            font-size: 2rem;
                        }

                        .style-selector {
                            flex-wrap: wrap;
                            gap: 8px;
                        }

                        .style-btn {
                            flex: 1 1 calc(50% - 4px);
                            min-width: auto;
                            padding: 10px 8px;
                            font-size: 0.85rem;
                        }

                        .send-buttons {
                            flex-direction: column;
                        }

                        .text-preview {
                            font-size: 1rem;
                            padding: 20px;
                        }

                        .alternatives-popup {
                            max-width: 250px;
                        }
                    }
                </style>

                <div class="invitation-content">
                    <button class="invitation-close" onclick="invitationCreator.close()">√ó</button>

                    <div class="invitation-header">
                        <h2>${emoji} –°—Ç–≤–æ—Ä–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—è</h2>
                        <p>–û–±–µ—Ä–∏ —Å—Ç–∏–ª—å —ñ –Ω–∞–ª–∞—à—Ç—É–π —Ç–µ–∫—Å—Ç –ø—ñ–¥ —Å–µ–±–µ</p>
                    </div>

                    <div class="style-selector" id="style-selector"></div>

                    <div class="hint-text">
                        üí° –ù–∞–≤–µ–¥–∏ –Ω–∞ –≤–∏–¥—ñ–ª–µ–Ω—ñ —Å–ª–æ–≤–∞, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏
                    </div>

                    <div class="text-preview" id="text-preview"></div>

                    <div class="send-buttons">
                        <button class="send-btn telegram" onclick="invitationCreator.sendToTelegram()">
                            <span>üì±</span>
                            <span>–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ Telegram</span>
                        </button>
                        <button class="send-btn whatsapp" onclick="invitationCreator.sendToWhatsApp()">
                            <span>üí¨</span>
                            <span>–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ WhatsApp</span>
                        </button>
                    </div>
                </div>
            `;

            document.body.appendChild(this.modal);

            this.modal.addEventListener('click', (e) => {
                if (e.target === this.modal) {
                    this.close();
                }
            });
        }

        render() {
            this.renderStyleSelector();
            this.renderTextPreview();
        }

        renderStyleSelector() {
            const selector = document.getElementById('style-selector');
            selector.innerHTML = '';

            Object.keys(this.templates).forEach(styleKey => {
                const style = this.templates[styleKey];
                const btn = document.createElement('button');
                btn.className = `style-btn ${styleKey === this.currentStyle ? 'active' : ''}`;
                btn.innerHTML = `<span>${style.icon}</span><span>${style.name}</span>`;
                btn.onclick = () => {
                    this.currentStyle = styleKey;
                    this.selectedWords = {};
                    this.render();
                };
                selector.appendChild(btn);
            });
        }

        renderTextPreview() {
            const preview = document.getElementById('text-preview');
            const template = this.templates[this.currentStyle];

            let text = template.text;

            const variationsWithPositions = template.variations.map((variation, index) => {
                const position = text.indexOf(variation.word);
                return { variation, index, position };
            }).filter(item => item.position !== -1)
              .sort((a, b) => b.position - a.position);

            variationsWithPositions.forEach(({ variation, index }) => {
                const wordPattern = variation.word;

                let selectedValue = this.selectedWords[index];
                if (!selectedValue) {
                    const match = wordPattern.match(/\{([^}]+)\}/);
                    if (match) {
                        const options = match[1].split('/');
                        selectedValue = options[Math.floor(Math.random() * options.length)];
                    } else {
                        selectedValue = wordPattern;
                    }
                }

                const span = `<span class="editable-word" data-index="${index}">${selectedValue}</span>`;
                text = text.replace(wordPattern, span);
            });

            text = text.replace(/\n/g, '<br>');

            preview.innerHTML = text;

            preview.querySelectorAll('.editable-word').forEach(word => {
                word.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.showAlternatives(e, word);
                });
            });

            preview.addEventListener('click', () => {
                const popup = document.querySelector('.alternatives-popup');
                if (popup) {
                    popup.remove();
                }
            });
        }

        showAlternatives(event, wordElement) {
            const existingPopup = document.querySelector('.alternatives-popup');
            if (existingPopup) {
                existingPopup.remove();
            }

            const index = parseInt(wordElement.dataset.index);
            const template = this.templates[this.currentStyle];
            const variation = template.variations[index];

            const popup = document.createElement('div');
            popup.className = 'alternatives-popup';

            let allOptions = [...variation.alternatives];
            const match = variation.word.match(/\{([^}]+)\}/);
            if (match) {
                const wordOptions = match[1].split('/');
                wordOptions.forEach(opt => {
                    if (!allOptions.includes(opt)) {
                        allOptions.unshift(opt);
                    }
                });
            }

            allOptions.forEach(alt => {
                const option = document.createElement('div');
                option.className = 'alternative-option';
                if (alt === wordElement.textContent) {
                    option.classList.add('active');
                }
                option.textContent = alt;
                option.onclick = (e) => {
                    e.stopPropagation();
                    wordElement.textContent = alt;
                    this.selectedWords[index] = alt;
                    this.updateCurrentText();
                    popup.remove();
                };
                popup.appendChild(option);
            });

            if (variation.custom) {
                const customSection = document.createElement('div');
                customSection.className = 'custom-input-section';
                customSection.innerHTML = `
                    <input type="text" class="custom-input" placeholder="–¢–≤—ñ–π –≤–∞—Ä—ñ–∞–Ω—Ç...">
                    <button class="custom-btn">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
                `;
                popup.appendChild(customSection);

                const input = customSection.querySelector('.custom-input');
                const btn = customSection.querySelector('.custom-btn');

                btn.onclick = (e) => {
                    e.stopPropagation();
                    if (input.value.trim()) {
                        wordElement.textContent = input.value.trim();
                        this.selectedWords[index] = input.value.trim();
                        this.updateCurrentText();
                        popup.remove();
                    }
                };

                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        e.stopPropagation();
                        btn.click();
                    }
                });

                input.addEventListener('click', (e) => e.stopPropagation());
            }

            const rect = wordElement.getBoundingClientRect();
            popup.style.left = rect.left + 'px';
            popup.style.top = (rect.bottom + 5) + 'px';

            document.body.appendChild(popup);

            setTimeout(() => {
                const popupRect = popup.getBoundingClientRect();
                if (popupRect.right > window.innerWidth) {
                    popup.style.left = (window.innerWidth - popupRect.width - 10) + 'px';
                }
                if (popupRect.bottom > window.innerHeight) {
                    popup.style.top = (rect.top - popupRect.height - 5) + 'px';
                }
            }, 0);

            popup.addEventListener('click', (e) => e.stopPropagation());

            const closePopup = () => {
                if (popup.parentNode) {
                    popup.remove();
                }
                document.removeEventListener('click', closePopup);
            };

            setTimeout(() => {
                document.addEventListener('click', closePopup);
            }, 100);
        }

        updateCurrentText() {
            const preview = document.getElementById('text-preview');
            const clone = preview.cloneNode(true);
            clone.querySelectorAll('br').forEach(br => {
                br.replaceWith('\n');
            });
            this.currentText = clone.textContent;
        }

        getCurrentText() {
            this.updateCurrentText();
            return this.currentText;
        }

        sendToTelegram() {
            const text = this.getCurrentText();
            const encodedText = encodeURIComponent(text);
            const telegramUrl = `https://t.me/share/url?url=&text=${encodedText}`;

            // Track Telegram share
            trackEvent('invitation_share', {
                messenger: 'telegram',
                style: this.currentStyle,
                textLength: text.length,
                text: text.substring(0, 500) // Limit text length for logging
            });

            window.open(telegramUrl, '_blank', 'width=600,height=600');
        }

        sendToWhatsApp() {
            const text = this.getCurrentText();
            const encodedText = encodeURIComponent(text);
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

            // Track WhatsApp share
            trackEvent('invitation_share', {
                messenger: 'whatsapp',
                style: this.currentStyle,
                textLength: text.length,
                text: text.substring(0, 500) // Limit text length for logging
            });

            let whatsappUrl;
            if (isMobile) {
                whatsappUrl = `whatsapp://send?text=${encodedText}`;
            } else {
                whatsappUrl = `https://web.whatsapp.com/send?text=${encodedText}`;
            }

            window.open(whatsappUrl, '_blank');
        }
    }

    // Global instance
    let invitationCreator;

    function openInvitationCreator() {
        if (!invitationCreator) {
            invitationCreator = new InvitationCreator();
            window.invitationCreator = invitationCreator;
        }
        invitationCreator.open();
    }

    // ESC to close
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && invitationCreator && invitationCreator.modal) {
            invitationCreator.close();
        }
    });

    // Expose globally
    window.invitationCreator = invitationCreator;
    window.openInvitationCreator = openInvitationCreator;
    window.InvitationCreator = InvitationCreator;

    console.log(`${invConfig.emoji || '‚ú®'} Invitation Creator –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ`);

})();